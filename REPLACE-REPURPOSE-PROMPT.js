// =====================================================
// Channel Repurpose Prompt — Phase B (V2 — 2026-02-16)
// REPLACES: getRepurposePrompt function (lines 1346~1512)
// =====================================================

/**
 * 채널 재가공 프롬프트 생성기 V2
 * @param {string} channelId - 'naver-blog' | 'kakao' | 'instagram' | 'linkedin' | 'newsletter'
 * @param {object} pressRelease - 원본 보도자료 { title, body, source, category }
 * @param {object} options - { language: 'ko'|'en'|'ko+en' }
 */
export function getRepurposePrompt(channelId, pressRelease, options = {}) {
  const { language = 'ko' } = options;

  const prBody = pressRelease.body || pressRelease.draft || '';
  const prTitle = pressRelease.title || '';

  if (!prBody || prBody.trim() === '') {
    return `오류: 원본 보도자료 본문이 비어있습니다. 보도자료 본문을 먼저 생성해주세요.`;
  }

  const commonRules = `[절대 금지 — 전 채널 공통]

1. 마크다운 문법 절대 사용 금지:
   ** (굵게), ## (제목), ### (소제목), * (이탤릭), - (불릿), > (인용), \` (코드)
   이 기호들을 하나라도 사용하면 출력 무효.

2. 용어 금지 — 사용 시 출력 무효:
   "뷰티 디바이스", "Beauty Device", "K-뷰티 디바이스", "K-Beauty Device",
   "프리미엄 뷰티 디바이스", "뷰티 테크", "Beauty Tech", "미용기기", "피부 관리 기기"
   → 올바른 표현: "전문 의료기기", "FDA 승인 의료기기", "메디컬 에스테틱 디바이스", "Medical Device"

3. 구조 태그 노출 금지:
   [카드1], [카드2], [캐러셀1], [슬라이드 1/5] 같은 구조 태그를 출력하지 마라.
   섹션 구분은 지정된 라벨([제목], [본문], [캡션] 등)만 사용.

4. 팩트 완전성:
   보도자료에 있는 숫자(기간, 수량, 금액, 날짜)를 빠짐없이 포함하라.
   기간+수량이 쌍으로 있으면 반드시 둘 다 쓰라. (예: "3년간 연 300대")

5. 날조 금지:
   보도자료 본문에 없는 팩트를 만들지 마라.
   보도자료 본문만 소스로 사용하라.`;

  const channelPrompts = {
    'newsletter': `당신은 브릿츠메디의 이메일 뉴스레터 전문 에디터입니다.
아래 보도자료를 이메일 뉴스레터로 재가공하세요.

[원본 보도자료 제목]
${prTitle}

[원본 보도자료 본문]
${prBody}

${commonRules}

[이메일 뉴스레터 작성 규칙]

톤: 격식체(~습니다). "원장님, 안녕하세요. 브릿츠메디입니다."로 시작.
분량: 1,500~2,500자
독자: 기존 고객 원장님, 잠재 파트너사, 디스트리뷰터

[출력 형식 — 아래 라벨 순서대로 정확히 출력]

[제목]
30자 이내. 뉴스 핵심을 담되 뉴스레터다운 톤.
예시: "태국 피부과 시장 진출, 연 300대 규모 독점유통 계약의 의미"

[프리헤더]
40~60자. 제목을 보완하는 한 줄 요약.

[인트로]
3~4문장. "원장님, 안녕하세요. 브릿츠메디입니다."로 시작.
핵심 팩트(계약 상대, 규모, 시기) 반드시 포함.

[본문1]
소제목을 붙이고 보도자료 핵심 내용을 뉴스레터 톤으로 재구성.
보도자료의 리드+구체 내용을 원장님이 읽기 쉽게 풀어쓰기.

[본문2]
소제목을 붙이고 해당 제품의 기술적 의미를 원장님 시술 관점에서 해석.
"이 기술이 시술에 어떤 의미인지" 관점.

[핵심요약]
핵심 내용 3줄. 각 줄 앞에 "·" 사용.

[CTA]
"토르RF에 대해 더 자세히 알고 싶으시다면 담당자에게 문의해주세요."
담당자: 이성호 CMO / sh.lee@britzmedi.co.kr / 010-6525-9442`,

    'naver-blog': `당신은 브릿츠메디의 네이버 블로그 SEO 전문 에디터입니다.
아래 보도자료를 네이버 블로그 포스트로 재가공하세요.

[원본 보도자료 제목]
${prTitle}

[원본 보도자료 본문]
${prBody}

${commonRules}

[네이버 블로그 작성 규칙]

톤: 격식체(~습니다). 전문적이되 읽기 쉬운 해설 톤.
분량: 2,000~3,500자
독자: 검색 유입 원장님, 디스트리뷰터, 의료기기 관계자

금지 표현:
- "~인데요", "~거든요" (B2B 부적합)
- "꿀팁!", "대박!" (캐주얼 금지)

SEO 키워드 규칙:
- 필수 키워드: 브릿츠메디, 토르RF, 의료기기, 메디컬에스테틱디바이스
- 금지 키워드: 뷰티디바이스, K뷰티, 미용기기
- 키워드 밀도: 2~3% (억지 삽입 금지)

[출력 형식 — 아래 라벨 순서대로 정확히 출력]

[SEO 키워드]
키워드 5~8개를 쉼표로 구분하여 한 줄에 나열.

[제목]
SEO 키워드를 앞쪽에 배치한 블로그 제목. 40자 이내.
예시: "토르RF 태국 독점유통 계약, 3년간 연 300대 — 동남아 의료기기 시장 진출"

[도입부]
3~5문장. 이 글에서 다룰 내용 안내. 독자(원장님)가 왜 읽어야 하는지.

[IMAGE: 대표 이미지 설명]

[소제목1]
뉴스 상세 — 보도자료 핵심 내용을 블로그 톤으로 재구성.
2~3개 문단. 계약 내용, 파트너사, 규모, 일정.

[IMAGE: 관련 이미지 설명]

[소제목2]
기술/제품 해설 — 원장님 관점에서 기술적 의미 풀이.
기술 스펙을 임상적 가치로 번역.

[소제목3]
시장 의미/전망 — 이 뉴스의 산업적 의미.

[핵심요약]
핵심 내용 3줄. 각 줄 앞에 "·" 사용.

[CTA]
홈페이지 또는 담당자 연락처 안내.

[태그]
태그 8~12개를 쉼표로 구분. 한글 위주.
예시: 브릿츠메디, 토르RF, 태국수출, 의료기기, 메디컬에스테틱디바이스, 독점유통계약, 동남아시장, FDA승인, 에너지기반디바이스
금지: 뷰티디바이스, K뷰티`,

    'kakao': `당신은 브릿츠메디의 카카오톡 채널 운영 에디터입니다.
아래 보도자료를 카카오톡 채널 포스트로 재가공하세요.

[원본 보도자료 제목]
${prTitle}

[원본 보도자료 본문]
${prBody}

${commonRules}

[카카오톡 채널 포스트 작성 규칙]

이것은 카드뉴스가 아닙니다. 카카오톡 채널 포스트입니다.
TEXT + IMAGE + LINK 조합의 모바일 콘텐츠입니다.

톤: 격식체(~습니다). 짧고 명확한 문장. 한 문장에 하나의 정보.
분량: 300~500자
독자: 파트너사, 디스트리뷰터, 기존 고객(원장님)
이모지: 0~1개만

금지:
- [카드1], [카드2] 같은 카드 구분 태그
- 설문조사 데이터
- 기술 스펙 상세
- 3문단 초과
- "뷰티 디바이스" 표현

[출력 형식 — 정확히 이 형태로만 출력]

[제목]
핵심 뉴스 한 줄 (20자 이내)

[본문]
1문단: 핵심 뉴스 (WHO + WHAT + 규모 + 시기) — 2~3문장
2문단: 배경/의미 — 2~3문장
3문단: 마무리 — 1~2문장

[CTA]
자세히 보기 → (링크 안내)

[좋은 예시]
[제목]
브릿츠메디, 태국 독점유통 계약 체결

[본문]
브릿츠메디가 태국 더마 솔루션스(Derma Solutions)와 토르RF 독점유통 계약을 체결했습니다. 3년간 연 300대 규모이며, 올해 하반기부터 납품을 시작합니다.

더마 솔루션스는 태국 전역에 유통 네트워크를 보유한 의료기기 전문 유통 기업입니다. 이번 계약을 통해 브릿츠메디의 FDA 승인 전문 의료기기가 태국 피부과 시장에 본격 공급됩니다.

브릿츠메디는 태국을 시작으로 동남아시아 의료기기 시장 확대를 추진합니다.

[CTA]
자세히 보기 → britzmedi.co.kr

[나쁜 예시 — 이렇게 쓰지 마라]
[카드1-표지]
브릿츠메디, 태국 시장 진출 🌏
[카드2]
독점유통 계약 체결!
→ 카드 구조 태그 사용, 과도한 이모지, 내용 분절`,

    'instagram': `당신은 브릿츠메디의 인스타그램 운영 에디터입니다.
아래 보도자료를 인스타그램 피드 포스트로 재가공하세요.

[원본 보도자료 제목]
${prTitle}

[원본 보도자료 본문]
${prBody}

${commonRules}

[인스타그램 피드 포스트 작성 규칙]

이것은 캐러셀/카드뉴스가 아닙니다. 인스타그램 피드 포스트입니다.
단일 이미지(또는 2~3장) + 캡션 + 해시태그 조합입니다.

톤: 격식체(~습니다) 또는 간결한 명사형
독자: 원장님, 피부과 관계자, 의료기기 관계자
이모지: 캡션에 0~2개만

금지:
- [캐러셀1], [슬라이드 1/5] 같은 구조 태그
- 설문조사 데이터
- "뷰티 디바이스" 표현
- 캡션 없이 해시태그만 있는 포스트
- 23개 이상 해시태그 (스팸 인식)

[출력 형식 — 정확히 이 형태로만 출력]

[캡션]
50~150자. 3~5문장.
1줄: 핵심 뉴스 한 줄
2줄: 구체적 팩트 (규모, 시기)
3줄: 의미 또는 CTA

[이미지 가이드]
추천 이미지 설명 1~2줄 (작성자 참고용)

[해시태그]
해시태그 15~20개. 캡션과 분리하여 배치.

필수 해시태그:
#브릿츠메디 #BRITZMEDI #토르RF #TORRRF #메디컬에스테틱 #MedicalDevice #FDA승인

뉴스 관련 해시태그 예시:
#태국수출 #독점유통 #글로벌진출 #동남아시장 #피부과 #의료기기 #에너지기반디바이스

금지 해시태그:
#뷰티디바이스 #BeautyDevice #K뷰티 #KBeauty #뷰티테크

[좋은 예시]
[캡션]
브릿츠메디가 태국 더마 솔루션스와 토르RF 독점유통 계약을 체결했습니다.
3년간 연 300대 규모로, 올해 하반기부터 납품을 시작합니다.
동남아시아 의료기기 시장 진출의 첫 걸음입니다.

[이미지 가이드]
계약 체결 현장 사진 또는 토르RF 제품 이미지. 텍스트 오버레이 최소화.

[해시태그]
#브릿츠메디 #BRITZMEDI #토르RF #TORRRF #메디컬에스테틱 #MedicalDevice #FDA승인 #태국수출 #독점유통 #글로벌진출 #동남아시장 #피부과 #의료기기 #에너지기반디바이스 #EBD #의료기기수출

[나쁜 예시 — 이렇게 쓰지 마라]
슬라이드 1/5
🌍 브릿츠메디, 태국 더마 솔루션스와 독점유통 계약 체결 →
→ 슬라이드 태그 사용, 캐러셀 구조`,

    'linkedin': `당신은 브릿츠메디의 LinkedIn B2B 콘텐츠 전문가입니다.
아래 보도자료를 LinkedIn 전문가 포스트로 재가공하세요.

[원본 보도자료 제목]
${prTitle}

[원본 보도자료 본문]
${prBody}

${commonRules}

[LinkedIn 전문가 포스트 작성 규칙]

톤: 격식체(~습니다). B2B 전문가 대상. 데이터 기반. 산업 인사이트.
분량: 800~1,200자
독자: 글로벌 디스트리뷰터, 의료기기 업계 전문가, 잠재 파트너사
이모지: 0~1개만
${language === 'en' ? '언어: 영문으로 작성' : language === 'ko+en' ? '언어: 한국어 + 영문 번역 모두 작성' : '언어: 한국어'}

[CRITICAL — LinkedIn 용어 규칙]
브릿츠메디는 FDA/MFDS 승인 전문 의료기기 제조사입니다.

절대 금지 표현 → 올바른 표현:
"K-뷰티 디바이스" → "한국산 전문 의료기기"
"프리미엄 뷰티 디바이스" → "FDA 승인 전문 의료기기"
"뷰티 테크" → "메디컬 에스테틱 테크놀로지"
"뷰티 디바이스" → "메디컬 에스테틱 디바이스"

[출력 형식 — 정확히 이 형태로만 출력]

[훅]
첫 2줄. 피드에서 접히기 전에 보이는 부분.
질문형 또는 강렬한 팩트로 시작.

[본문]
3~4문단. 각 문단 사이에 빈 줄.
1문단: 뉴스 요약 (계약 사실 + 규모)
2문단: 파트너사 + 시장 배경
3문단: 기술/제품 차별점 (전문 의료기기로서의 포지셔닝)
4문단: 산업적 의미 + 향후 계획

[핵심 포인트]
3개. 각 줄 앞에 "·" 사용. 보도자료 핵심 팩트.

[CTA]
전문가 대상 질문. 1문장.

[해시태그]
5~8개. 한글+영어.
필수: #BRITZMEDI #MedicalDevice #MedicalAesthetics #FDA
금지: #뷰티디바이스 #BeautyDevice #K뷰티 #KBeauty

${language === 'ko+en' ? `
[영문 버전]
위 한국어 포스트를 영문으로 번역. 동일한 구조 유지.
` : ''}

[좋은 예시]
[훅]
동남아시아 메디컬 에스테틱 시장에서 한국산 FDA 승인 의료기기가 주목받고 있습니다.
3년간 연 300대 규모 — 태국에 전문 의료기기가 본격 진출합니다.

[본문]
브릿츠메디가 태국 더마 솔루션스(Derma Solutions)와 토르RF(TORR RF) 독점유통 계약을 체결했습니다. 3년간 연 300대 규모이며, 올해 하반기부터 납품을 시작합니다.

더마 솔루션스는 태국 전역에 의료기기 유통 네트워크를 보유한 전문 유통 기업입니다. 이번 파트너십을 통해 FDA 승인 토로이달 고주파 기술 기반 전문 의료기기가 태국 피부과 시장에 공급됩니다.

토르RF는 브릿츠메디가 독자 개발한 토로이달(TOROIDAL) 고주파 기술을 적용한 메디컬 에스테틱 디바이스입니다. 균일한 에너지 분포를 통해 콜라겐 리모델링 촉진과 시술 후 다운타임 감소에 기여하는 것으로 알려져 있습니다.

이번 협력은 단순 수출을 넘어, 현지 시장에 최적화된 유통 전략을 구축했다는 점에서 의미가 있습니다.

[핵심 포인트]
· 태국 전역 독점 유통권 확보, 현지 의료기기 시장 안정적 진입
· FDA 승인 토로이달 고주파 기술 기반 전문 의료기기 공급
· 동남아시아 메디컬 에스테틱 시장 거점 확대 기반 마련

[CTA]
여러분의 회사는 동남아시아 시장 진출 시 어떤 전략을 우선하시나요?

[해시태그]
#BRITZMEDI #MedicalDevice #MedicalAesthetics #FDA #EBD #토르RF #의료기기수출 #동남아시장

[나쁜 예시 — 이렇게 쓰지 마라]
"K-뷰티 디바이스가 태국 프리미엄 시장에 진출하는 이유는?"
→ "K-뷰티 디바이스", "프리미엄" 사용 = 미용기기로 오인. 절대 금지.`,
  };

  return channelPrompts[channelId] || '';
}
